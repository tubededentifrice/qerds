# phoss SMP Configuration for QERDS
# ETSI EN 319 522 / BDXR SMP Metadata Publishing
#
# Reference: https://github.com/phax/phoss-smp/wiki/Configuration

# =============================================================================
# Backend Selection
# =============================================================================
# Use SQL backend for persistent storage
smp.backend=sql

# =============================================================================
# Database Configuration (PostgreSQL)
# =============================================================================
# phoss SMP supports MySQL 5.x/8.x, PostgreSQL 13/14+
# Using PostgreSQL to minimize infrastructure complexity (shared DB server possible)
jdbc.driver=org.postgresql.Driver
jdbc.url=jdbc:postgresql://smp-postgres:5432/smp
jdbc.user=smp
jdbc.password=${SMP_DB_PASSWORD:-smp_dev_password}
jdbc.schema=smp
jdbc.schema-create=true
target-database=PostgreSQL

# Connection pool settings (sensible defaults for dev)
jdbc.pooling.max-connections=10
jdbc.pooling.max-wait.millis=10000
jdbc.pooling.between-evictions-runs.millis=300000
jdbc.pooling.min-evictable-idle.millis=1800000

# Enable slow query warnings for debugging
jdbc.execution-time-warning.enabled=true
jdbc.execution-time-warning.ms=1000

# =============================================================================
# Flyway Database Migration
# =============================================================================
# Automatically manage database schema versions
smp.flyway.enabled=true

# =============================================================================
# SMP Server Identity
# =============================================================================
# Unique identifier for this SMP instance (update for production)
sml.smpid=QERDS-SMP-DEV
sml.enabled=false

# =============================================================================
# REST API Configuration
# =============================================================================
# Enable the SMP REST API for programmatic access
smp.rest.type=bdxr1
smp.rest.writable-api.enabled=true
smp.rest.log-exceptions=true

# =============================================================================
# Service Information
# =============================================================================
# SMP service metadata for discovery
smp.publicurl=http://localhost:8280

# =============================================================================
# Security Configuration
# =============================================================================
# Directory services / trust configuration
# In production, configure actual truststore for partner validation

# Disable forced HTTPS redirect for development
# (in production, SMP MUST use HTTPS from Feb 2026)
smp.forceroot=false

# Basic authentication for management API (development only)
# WARNING: Change these credentials in production!
smp.rest.user=smp-admin
smp.rest.password=${SMP_ADMIN_PASSWORD:-smp_admin_dev}

# =============================================================================
# SML Integration (Service Metadata Locator)
# =============================================================================
# SML registration is disabled by default for local development
# Enable and configure for production Peppol/eDelivery network participation
sml.enabled=false
# sml.url=https://sml.peppolcentral.org/
# sml.client.cert.required=true

# =============================================================================
# Status API
# =============================================================================
# Enable status endpoint for health checks
smp.status.enabled=true
smp.status.sql.enabled=true

# =============================================================================
# Logging
# =============================================================================
# Log level configuration (see logback.xml for detailed settings)
smp.log.level=INFO

# =============================================================================
# Development Mode Settings
# =============================================================================
# These settings are appropriate for development only
# For production, consult the phoss SMP documentation

# Disable client certificate requirements for dev
smp.clientcert.required=false

# Allow insecure HTTP for local development
smp.https.required=false
