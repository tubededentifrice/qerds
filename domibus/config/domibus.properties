# Domibus AS4 Gateway Configuration
# For QERDS ETSI EN 319 522 Interoperability
#
# Reference: https://ec.europa.eu/digital-building-blocks/sites/display/DIGITAL/Domibus

# =============================================================================
# Database Configuration (MySQL 8)
# =============================================================================
domibus.datasource.driverClassName=com.mysql.cj.jdbc.Driver
domibus.datasource.url=jdbc:mysql://domibus-mysql:3306/domibus?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
domibus.datasource.user=domibus
domibus.datasource.password=${DOMIBUS_DB_PASSWORD:-domibus_dev_password}

# Connection pool settings
domibus.datasource.maxLifetime=300000
domibus.datasource.maxPoolSize=20

# =============================================================================
# MSH Configuration (Message Service Handler)
# =============================================================================
# Unique identifier for this Access Point
domibus.msh.endpoint=http://domibus:8080/domibus/services/msh

# MSH retry configuration for failed message delivery
domibus.msh.retry.cron=0/30 * * * * ?
domibus.msh.retry.count=3

# =============================================================================
# Security Configuration
# =============================================================================
# Keystore for signing messages (dev: use self-signed)
domibus.security.keystore.type=JKS
domibus.security.keystore.password=${DOMIBUS_KEYSTORE_PASSWORD:-changeit}
domibus.security.keystore.location=/opt/domibus/conf/keystores/gateway_keystore.jks

# Truststore for verifying partner certificates
domibus.security.truststore.type=JKS
domibus.security.truststore.password=${DOMIBUS_TRUSTSTORE_PASSWORD:-changeit}
domibus.security.truststore.location=/opt/domibus/conf/keystores/gateway_truststore.jks

# Key alias for this AP's signing certificate
domibus.security.key.alias=blue_gw

# =============================================================================
# Authentication
# =============================================================================
# Admin console authentication
# WARNING: Change these in production!
domibus.auth.unsecureLoginAllowed=true
domibus.console.login.defaultUser=admin
domibus.console.login.defaultPassword=changeit

# Plugin authentication
domibus.auth.singleExtAuthProvider=false

# =============================================================================
# Plugins
# =============================================================================
# WebService plugin for REST API integration
domibus.plugin.ws.enabled=true

# Default plugin for receiving messages
domibus.plugin.default=ws

# =============================================================================
# Logging
# =============================================================================
domibus.logging.level=INFO
domibus.logging.payload.print=false

# =============================================================================
# Message Storage
# =============================================================================
# Payload storage location
domibus.attachment.storage.location=/opt/domibus/data/attachments

# Message retention (days)
domibus.retentionWorker.message.retention.downloaded.max.delete=5000
domibus.retentionWorker.message.retention.not_downloaded.max.delete=5000

# =============================================================================
# Notifications (for integration with qerds-api)
# =============================================================================
# Callback URL for message notifications (qerds-api webhook)
# domibus.plugin.notification.url=http://qerds-api:8000/webhooks/domibus

# =============================================================================
# ETSI AS4 Profile Settings
# =============================================================================
# Enable AS4 profile compliance
domibus.msh.as4.mpc.enabled=true

# Message properties
domibus.msh.message.id.suffix=@qerds.local

# =============================================================================
# Development Mode Settings
# =============================================================================
# These settings are appropriate for development only
# For production, consult the Domibus Administration Guide

# Allow unsigned messages in dev (disable in production!)
domibus.dynamicDiscovery.useDynamicDiscovery=false

# Self-sender testing enabled
domibus.msh.messageid.suffix.selftest=.selftest

# =============================================================================
# Clustering (disabled for single-node dev deployment)
# =============================================================================
domibus.deployment.clustered=false
